
<!DOCTYPE html>
<html>
<head>
    <!-- include jQuery-->
    <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

    <!-- include d3 script -->
    <script src="scripts/d3/d3.min.js" charset="utf-8"></script>

    <!-- include the graph script  -->
    <script src="pids-graph-1.js" charset="utf-8"></script>

    <!-- Load the correct json and pass it to the script above -->

    <script>

    $.ajax({
        dataType: "json",
        url: "pids_data.json",
        success: function(data, textStatus, jqXHR){

            pidsGraph.setDataSet(data);
            pidsGraph.drawLine();
        }
    });

    </script>
    <!-- demo scripting-->
    <script>
        var h = 100;
        var w = 400;


        function showHeader(ds) {

            d3.select("body").append("h1")
                .text(ds.category + " Sales (2013)");

        }

        function buildLine(ds) {

            console.log("ds", ds);


            var lineFun = d3.svg.line()
              .x(function (d) { return ((d.month - 20130001) / 1.25); })
              .y(function (d) { return h - d.sales; })
              .interpolate("linear");

            //var lineFun = d3.svg.line()
            // .x(function (d) { return ((d.month - 20130001) / 3.25); })
            // .y(function (d) { return h - d.sales; })
            // .interpolate("linear");

            var svg = d3.select("body").append("svg").attr({ width: w, height: h });

            var viz = svg.append("path")
              .attr({
                  d: lineFun(ds.monthlySales), //we have to refernce the sales data array
                  "stroke": "purple",
                  "stroke-width": 2,
                  "fill": "none"
              });

        }


        //call to load data and then build our viz
        d3.json("https://api.github.com/repos/bsullins/d3js-resources/contents/monthlySalesbyCategoryMultiple.json", function (error, data) {

            //check the file loaded properly
            if (error) {
                console.log(error);
            } else {
                console.log(data);  //raw data
            }

            //decode our base64 data
            //and convert it into an array
            var decodedData = JSON.parse(window.atob(data.content));

            //see what we've got
            //should be [Object, Object]
            console.log(decodedData.contents);


            decodedData.contents.forEach(function (ds) {
                console.log(ds);
                showHeader(ds); //give our chart a title
                buildLine(ds); //draw our line
            });




        });

    </script>
</head>
<body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Project name</a>
            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Home</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </div><!--/.nav-collapse -->
        </div>
    </nav>

    <div class="container" style="margin-top: 70px;">
        <div class="row" style="margin-bottom: 20px;">
            <div class="col-md-4">
                <label for="companyName">Company Name</label>
                <input id="companyName" type="text" class="form-control" value="WEYLAND-YUTANI">
            </div>
            <div class="col-md-4">
                <label for="atCode">AT-code</label>
                <select id="atCode" class="form-control">
                    <option>201</option>
                    <option>202</option>
                    <option>203</option>
                    <option>204</option>
                    <option>205</option>
                </select>
            </div>
            <div class="col-md-4">
                <label for="geoRegion">Geographical region</label>
                <select id="geoRegion" class="form-control">
                    <option>EMEA</option>
                    <option>NA</option>
                    <option>SA</option>
                    <option>BRICS</option>
                    <option>MENA</option>
                </select>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Agent company</th>
                                <th>Sales</th>
                                <th>Growth %</th>
                                <th>Market Growth %</th>
                                <th>Market Share %</th>
                                <th>Evolution index</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>WEYLAND-YUTANI</td>
                                <td>EUR 342.231.121</td>
                                <td>21%</td>
                                <td>33%</td>
                                <td>44%</td>
                                <td>80</td>
                            </tr>
                    </table>
                </div>

            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Sales</th>
                                <th>Growth %</th>
                                <th>Market Growth %</th>
                                <th>Market Share %</th>
                                <th>Evolution index</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>BLALBA</td>
                                <td>EUR 342.231.121</td>
                                <td>21%</td>
                                <td>33%</td>
                                <td>44%</td>
                                <td>80</td>
                            </tr>
                            <tr>
                                <td>BLALBA</td>
                                <td>EUR 342.231.121</td>
                                <td>21%</td>
                                <td>33%</td>
                                <td>44%</td>
                                <td>80</td>
                            </tr>
                            <tr>
                                <td>BLALBA</td>
                                <td>EUR 342.231.121</td>
                                <td>21%</td>
                                <td>33%</td>
                                <td>44%</td>
                                <td>80</td>
                            </tr>
                            <tr>
                                <td>BLALBA</td>
                                <td>EUR 342.231.121</td>
                                <td>21%</td>
                                <td>33%</td>
                                <td>44%</td>
                                <td>80</td>
                            </tr>
                            <tr>
                                <td>BLALBA</td>
                                <td>EUR 342.231.121</td>
                                <td>21%</td>
                                <td>33%</td>
                                <td>44%</td>
                                <td>80</td>
                            </tr>
                            <tr>
                                <td>BLALBA</td>
                                <td>EUR 342.231.121</td>
                                <td>21%</td>
                                <td>33%</td>
                                <td>44%</td>
                                <td>80</td>
                            </tr>
                    </table>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <h3>Market share %</h3>
            </div>
            <div class="col-md-12" id="market-share-container">
                <svg id="market-share"></svg>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <h3>Evolution index MAT%</h3>
            </div>
            <div class="col-md-12">
                <svg id="mat"></svg>
            </div>
        </div>


</body>
</html>